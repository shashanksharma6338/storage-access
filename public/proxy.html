
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gaming Hub - King's Portal</title>
    <script src="/libs/tailwindcss/tailwindcss.min.js"></script>
    <script>
        tailwind.config = {
            darkMode: 'class'
        }
    </script>
    <script src="/libs/xlsx/xlsx.full.min.js"></script>
    <script src="/libs/socket.io/socket.io.min.js"></script>
    <style>
        body {
            font-family: "Inter", sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }

        .dark body {
            background: linear-gradient(135deg, #2d1b69 0%, #11998e 100%);
        }

        button {
            background: linear-gradient(45deg, #667eea, #764ba2);
            border: none;
            color: white;
            font-weight: 600;
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
            transition: all 0.3s ease;
        }

        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.3);
        }

        .game-container {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(15px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            border-radius: 15px;
        }

        .dark .game-container {
            background: rgba(45, 55, 72, 0.95);
            border: 1px solid rgba(79, 209, 199, 0.2);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
        }

        .uno-card {
            width: 60px;
            height: 90px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid #333;
            box-shadow: 0 2px 4px rgba(0,0,0,0.3);
            font-weight: bold;
            font-size: 12px;
            text-align: center;
        }

        .uno-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.4);
        }

        .back-card {
            background: linear-gradient(45deg, #8B4513, #D2691E);
            color: white;
        }

        .red-card { background: linear-gradient(45deg, #ff4444, #cc0000); color: white; }
        .blue-card { background: linear-gradient(45deg, #4444ff, #0000cc); color: white; }
        .green-card { background: linear-gradient(45deg, #44ff44, #00cc00); color: white; }
        .yellow-card { background: linear-gradient(45deg, #ffff44, #cccc00); color: black; }
        .wild-card { background: linear-gradient(45deg, #ff0000, #00ff00, #0000ff, #ffff00); color: white; }

        .chess-square {
            width: 48px;
            height: 48px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            cursor: pointer;
        }

        .letter-btn {
            padding: 8px;
            border-radius: 4px;
            font-weight: 600;
            transition: all 0.2s ease;
            cursor: pointer;
        }
    </style>
</head>
<body class="min-h-screen flex items-center justify-center p-4">
    <div id="gaming-interface" class="max-w-full mx-auto game-container p-6">
        <header class="flex justify-between items-center mb-6">
            <h1 class="text-3xl font-bold text-purple-800">üéÆ King's Gaming Hub</h1>
            <div class="flex gap-2">
                <button id="fullscreen-btn" class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition">‚õ∂ Fullscreen</button>
                <button id="dark-mode-toggle" class="bg-gray-600 text-white px-4 py-2 rounded-lg hover:bg-gray-700 transition">üåô</button>
            </div>
        </header>

        <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
            <!-- Game List -->
            <div class="lg:col-span-1">
                <div class="game-container p-4 rounded-lg mb-4">
                    <h3 class="text-lg font-bold mb-3">üÜî Join Game by ID</h3>
                    <div class="space-y-3">
                        <div class="flex gap-2">
                            <input type="text" id="game-id-input" placeholder="Enter Game ID..." class="flex-1 px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                            <button id="join-by-id-btn" class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition">Join</button>
                        </div>
                    </div>
                </div>

                <div class="game-container p-4 rounded-lg mb-4">
                    <div class="flex justify-between items-center mb-4">
                        <h2 class="text-xl font-bold">Multiplayer Games</h2>
                        <button id="create-ludo-btn" class="bg-yellow-600 text-white px-4 py-2 rounded-lg hover:bg-yellow-700 transition">üé≤ New Ludo</button>
                    </div>
                    <div id="ludo-games-list" class="space-y-2 mb-4">
                        <p class="text-gray-500">No Ludo games</p>
                    </div>
                    <div class="flex justify-between items-center mb-4">
                        <h2 class="text-xl font-bold">Chess Games</h2>
                        <button id="create-game-btn" class="bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition">New Game</button>
                    </div>
                    <div id="games-list" class="space-y-2">
                        <p class="text-gray-500">No active games</p>
                    </div>
                </div>

                <div class="game-container p-4 rounded-lg mb-4">
                    <h3 class="text-xl font-bold mb-2">Arcade Games</h3>
                    <div class="grid grid-cols-1 gap-2">
                        <button class="w-full bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition" onclick="startTypingMaster()">‚å®Ô∏è Typing Master</button>
                        <button class="w-full bg-pink-600 text-white px-4 py-2 rounded-lg hover:bg-pink-700 transition" onclick="startSpaceInvaders()">üëæ Space Defense</button>
                        <button class="w-full bg-cyan-600 text-white px-4 py-2 rounded-lg hover:bg-cyan-700 transition" onclick="startMemoryGame()">üß† Memory Match</button>
                    </div>
                </div>

                <div class="game-container p-4 rounded-lg mb-4">
                    <h3 class="text-xl font-bold mb-2">Card Games</h3>
                    <div class="grid grid-cols-1 gap-2">
                        <button class="w-full bg-gradient-to-r from-red-500 to-blue-500 text-white px-4 py-2 rounded-lg hover:from-red-600 hover:to-blue-600 transition font-bold" onclick="startUNO()">üÉè UNO</button>
                    </div>
                </div>

                <div class="game-container p-4 rounded-lg">
                    <h3 class="text-xl font-bold mb-2">Classic Games</h3>
                    <div class="grid grid-cols-1 gap-2">
                        <button class="w-full bg-red-600 text-white px-4 py-2 rounded-lg hover:bg-red-700 transition" onclick="startHangman()">üéØ Hangman</button>
                        <button class="w-full bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition" onclick="startTicTacToe()">‚≠ï Tic Tac Toe</button>
                        <button class="w-full bg-purple-600 text-white px-4 py-2 rounded-lg hover:bg-purple-700 transition" onclick="startSnake()">üêç Snake Game</button>
                        <button class="w-full bg-orange-600 text-white px-4 py-2 rounded-lg hover:bg-orange-700 transition" onclick="startRockPaperScissors()">‚úÇÔ∏è Rock Paper Scissors</button>
                        <button class="w-full bg-gray-600 text-white px-4 py-2 rounded-lg hover:bg-gray-700 transition" onclick="startNumberGuess()">üî¢ Number Guessing</button>
                    </div>
                </div>
            </div>

            <!-- Game Board -->
            <div class="lg:col-span-2">
                <!-- Chess Game -->
                <div id="chess-game" class="game-container p-4 rounded-lg hidden">
                    <div class="flex justify-between items-center mb-4">
                        <h2 class="text-xl font-bold">Chess Game</h2>
                        <div id="game-status" class="text-lg font-semibold"></div>
                    </div>
                    <div id="chess-board" class="grid grid-cols-8 gap-1 w-96 h-96 mx-auto mb-4"></div>
                    <div id="game-info" class="text-center">
                        <p id="turn-indicator" class="text-lg font-semibold mb-2"></p>
                        <button id="leave-game-btn" class="bg-red-600 text-white px-4 py-2 rounded-lg hover:bg-red-700 transition">Leave Game</button>
                    </div>
                </div>

                <!-- Ludo Game -->
                <div id="ludo-game" class="game-container p-4 rounded-lg hidden">
                    <div class="flex justify-between items-center mb-4">
                        <h2 class="text-xl font-bold">üé≤ Multiplayer Ludo</h2>
                        <div class="flex gap-2">
                            <div id="ludo-status" class="text-lg font-semibold"></div>
                            <button id="leave-ludo-btn" class="bg-red-600 text-white px-4 py-2 rounded-lg hover:bg-red-700 transition">Leave Game</button>
                        </div>
                    </div>

                    <div id="ludo-setup" class="mb-4">
                        <div class="game-container p-4 rounded-lg mb-4">
                            <h3 class="text-xl font-bold mb-2">üé≤ Game Settings</h3>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <div>
                                    <label class="block text-sm font-medium mb-1">Game Mode:</label>
                                    <select id="game-mode" class="w-full p-2 border rounded-lg focus:ring-2 focus:ring-yellow-500">
                                        <option value="single">üéÆ Single Player vs Computer</option>
                                        <option value="multi">üë• Multiplayer</option>
                                    </select>
                                </div>
                                <div id="multiplayer-options">
                                    <label class="block text-sm font-medium mb-1">Number of Players:</label>
                                    <select id="player-count" class="w-full p-2 border rounded-lg focus:ring-2 focus:ring-yellow-500">
                                        <option value="2">2 Players</option>
                                        <option value="3">3 Players</option>
                                        <option value="4" selected>4 Players</option>
                                    </select>
                                </div>
                            </div>
                            <button id="start-ludo-game" class="w-full bg-gradient-to-r from-green-600 to-green-700 text-white px-6 py-3 rounded-lg hover:from-green-700 hover:to-green-800 transition mt-3 font-semibold shadow-lg">üöÄ Start Game</button>
                        </div>
                    </div>

                    <div id="ludo-board-container" class="relative mx-auto" style="width: 600px; height: 600px;">
                        <canvas id="ludo-board" width="600" height="600" class="border-4 border-gray-800 rounded-lg bg-white"></canvas>
                        <div id="ludo-controls" class="absolute bottom-4 left-4 flex gap-2">
                            <button id="roll-dice" class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition disabled:opacity-50" disabled>üé≤ Roll Dice</button>
                            <div id="dice-result" class="bg-white px-4 py-2 rounded-lg border-2 border-gray-300 min-w-12 text-center font-bold"></div>
                        </div>
                    </div>

                    <div id="ludo-info" class="text-center mt-4">
                        <p id="ludo-turn-indicator" class="text-lg font-semibold mb-2"></p>
                        <div id="player-list" class="flex justify-center gap-4 flex-wrap"></div>
                    </div>
                </div>

                <!-- Other Games Container -->
                <div id="other-games" class="game-container p-4 rounded-lg">
                    <h2 class="text-xl font-bold mb-4 text-center">Select a Game to Play</h2>
                    <div class="text-center text-gray-500">
                        <p>Choose a game from the sidebar to start playing!</p>
                        <div class="mt-4">
                            <span class="text-6xl">üéÆ</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Global variables
        let currentGame = null;
        let chessGames = [];
        let ludoGames = [];
        let currentLudoGame = null;
        let ludoCanvas = null;
        let ludoCtx = null;
        let socket = null;
        let selectedSquare = null;

        // Dark mode functionality
        document.getElementById('dark-mode-toggle').addEventListener('click', () => {
            document.documentElement.classList.toggle('dark');
        });

        // Fullscreen functionality
        document.getElementById('fullscreen-btn').addEventListener('click', () => {
            if (!document.fullscreenElement) {
                document.documentElement.requestFullscreen();
            } else {
                document.exitFullscreen();
            }
        });

        // Initialize WebSocket connection (mock for standalone)
        function initializeWebSocket() {
            console.log('WebSocket connection simulated');
        }

        // Chess Game Functions
        document.getElementById('create-game-btn').addEventListener('click', createGame);
        document.getElementById('leave-game-btn').addEventListener('click', leaveGame);

        async function createGame() {
            const gameId = 'chess_' + Date.now().toString();
            currentGame = {
                id: gameId,
                players: ['king'],
                status: 'waiting',
                board: initializeChessBoard(),
                turn: 'white'
            };
            showChessGame();
            alert(`Chess game created! Game ID: ${gameId}\nShare this ID with friends to play together.`);
        }

        function initializeChessBoard() {
            return [
                ['r', 'n', 'b', 'q', 'k', 'b', 'n', 'r'],
                ['p', 'p', 'p', 'p', 'p', 'p', 'p', 'p'],
                ['', '', '', '', '', '', '', ''],
                ['', '', '', '', '', '', '', ''],
                ['', '', '', '', '', '', '', ''],
                ['', '', '', '', '', '', '', ''],
                ['P', 'P', 'P', 'P', 'P', 'P', 'P', 'P'],
                ['R', 'N', 'B', 'Q', 'K', 'B', 'N', 'R']
            ];
        }

        async function joinGame(gameId) {
            if (!currentGame || currentGame.id !== gameId) {
                alert('Game not found');
                return;
            }
            showChessGame();
        }

        function showChessGame() {
            document.getElementById("other-games").classList.add("hidden");
            document.getElementById("chess-game").classList.remove("hidden");
            createChessBoard();
            updateGameInterface();
        }

        function createChessBoard() {
            const board = document.getElementById("chess-board");
            board.innerHTML = "";

            for (let row = 0; row < 8; row++) {
                for (let col = 0; col < 8; col++) {
                    const square = document.createElement("div");
                    square.className = `chess-square ${
                        (row + col) % 2 === 0 ? "bg-amber-100" : "bg-amber-800"
                    }`;
                    square.dataset.row = row;
                    square.dataset.col = col;
                    square.addEventListener("click", handleSquareClick);

                    if (currentGame && currentGame.board[row][col]) {
                        square.textContent = getPieceSymbol(currentGame.board[row][col]);
                    }

                    board.appendChild(square);
                }
            }
        }

        function getPieceSymbol(piece) {
            const symbols = {
                K: "‚ôî", Q: "‚ôï", R: "‚ôñ", B: "‚ôó", N: "‚ôò", P: "‚ôô",
                k: "‚ôö", q: "‚ôõ", r: "‚ôú", b: "‚ôù", n: "‚ôû", p: "‚ôü",
            };
            return symbols[piece] || "";
        }

        function handleSquareClick(event) {
            const square = event.target;
            const row = parseInt(square.dataset.row);
            const col = parseInt(square.dataset.col);

            if (selectedSquare) {
                // Make move (simplified)
                currentGame.board[row][col] = currentGame.board[selectedSquare.row][selectedSquare.col];
                currentGame.board[selectedSquare.row][selectedSquare.col] = '';
                currentGame.turn = currentGame.turn === 'white' ? 'black' : 'white';
                
                document.querySelectorAll(".chess-square").forEach((sq) => sq.classList.remove("bg-yellow-300"));
                selectedSquare = null;
                updateChessBoard();
                updateGameStatus();
            } else {
                if (currentGame.board[row][col]) {
                    selectedSquare = { row, col };
                    square.classList.add("bg-yellow-300");
                }
            }
        }

        function updateChessBoard() {
            const squares = document.querySelectorAll(".chess-square");
            squares.forEach((square) => {
                const row = parseInt(square.dataset.row);
                const col = parseInt(square.dataset.col);
                square.textContent = currentGame.board[row][col]
                    ? getPieceSymbol(currentGame.board[row][col])
                    : "";
            });
        }

        function updateGameInterface() {
            updateGameStatus();
            updateChessBoard();
        }

        function updateGameStatus() {
            const statusEl = document.getElementById("game-status");
            const turnEl = document.getElementById("turn-indicator");

            statusEl.textContent = `Status: ${currentGame.status}`;

            if (currentGame.status === "playing" || currentGame.status === "waiting") {
                turnEl.textContent = `${currentGame.turn === "white" ? "White" : "Black"}'s turn`;
            }
        }

        function leaveGame() {
            currentGame = null;
            document.getElementById("chess-game").classList.add("hidden");
            document.getElementById("other-games").classList.remove("hidden");
        }

        // Ludo Game Functions
        document.getElementById('create-ludo-btn').addEventListener('click', createLudoGame);
        document.getElementById('leave-ludo-btn').addEventListener('click', leaveLudoGame);
        document.getElementById('start-ludo-game').addEventListener('click', startLudoGame);
        document.getElementById('roll-dice').addEventListener('click', rollDice);

        async function createLudoGame() {
            const gameId = 'ludo_' + Date.now().toString();
            currentLudoGame = {
                id: gameId,
                players: [{name: 'king', pieces: [{position: -1}, {position: -1}, {position: -1}, {position: -1}], piecesInGoal: 0}],
                status: 'waiting',
                currentPlayerIndex: 0,
                diceRolled: false,
                lastDiceRoll: null,
                maxPlayers: 4
            };
            showLudoGame();
            alert(`Ludo game created! Game ID: ${gameId}\nShare this ID with friends to play together.`);
        }

        function showLudoGame() {
            document.getElementById("other-games").classList.add("hidden");
            document.getElementById("chess-game").classList.add("hidden");
            document.getElementById("ludo-game").classList.remove("hidden");

            ludoCanvas = document.getElementById("ludo-board");
            ludoCtx = ludoCanvas.getContext("2d");

            if (currentLudoGame.status === "waiting") {
                document.getElementById("ludo-setup").style.display = "block";
                document.getElementById("ludo-board-container").style.display = "none";
            } else {
                document.getElementById("ludo-setup").style.display = "none";
                document.getElementById("ludo-board-container").style.display = "block";
                initializeLudoBoard();
            }

            updateLudoGameInterface();
        }

        function startLudoGame() {
            currentLudoGame.status = 'playing';
            document.getElementById("ludo-setup").style.display = "none";
            document.getElementById("ludo-board-container").style.display = "block";
            initializeLudoBoard();
            updateLudoGameInterface();
        }

        function initializeLudoBoard() {
            if (!ludoCtx) return;
            ludoCtx.clearRect(0, 0, 600, 600);
            ludoCtx.fillStyle = "#f0f0f0";
            ludoCtx.fillRect(0, 0, 600, 600);
            drawLudoBoard();
            drawPieces();
        }

        function drawLudoBoard() {
            const colors = ["#ff4444", "#4444ff", "#44ff44", "#ffff44"];
            const cellSize = 40;

            // Draw home areas
            colors.forEach((color, i) => {
                const homeX = (i % 2) * 9 * cellSize;
                const homeY = Math.floor(i / 2) * 9 * cellSize;

                ludoCtx.fillStyle = color;
                ludoCtx.fillRect(homeX, homeY, 6 * cellSize, 6 * cellSize);
                ludoCtx.strokeStyle = "#000";
                ludoCtx.lineWidth = 2;
                ludoCtx.strokeRect(homeX, homeY, 6 * cellSize, 6 * cellSize);
            });

            // Draw path
            ludoCtx.fillStyle = "#ffffff";
            ludoCtx.strokeStyle = "#000";
            ludoCtx.lineWidth = 2;

            // Horizontal strips
            ludoCtx.fillRect(0, 6 * cellSize, 6 * cellSize, 3 * cellSize);
            ludoCtx.strokeRect(0, 6 * cellSize, 6 * cellSize, 3 * cellSize);
            ludoCtx.fillRect(9 * cellSize, 6 * cellSize, 6 * cellSize, 3 * cellSize);
            ludoCtx.strokeRect(9 * cellSize, 6 * cellSize, 6 * cellSize, 3 * cellSize);

            // Vertical strips
            ludoCtx.fillRect(6 * cellSize, 0, 3 * cellSize, 6 * cellSize);
            ludoCtx.strokeRect(6 * cellSize, 0, 3 * cellSize, 6 * cellSize);
            ludoCtx.fillRect(6 * cellSize, 9 * cellSize, 3 * cellSize, 6 * cellSize);
            ludoCtx.strokeRect(6 * cellSize, 9 * cellSize, 3 * cellSize, 6 * cellSize);

            // Center area
            ludoCtx.fillStyle = "#ffd700";
            ludoCtx.fillRect(6 * cellSize, 6 * cellSize, 3 * cellSize, 3 * cellSize);
            ludoCtx.strokeRect(6 * cellSize, 6 * cellSize, 3 * cellSize, 3 * cellSize);
        }

        function drawPieces() {
            if (!currentLudoGame) return;

            const colors = ["#ff4444", "#4444ff", "#44ff44", "#ffff44"];
            const cellSize = 40;

            currentLudoGame.players.forEach((player, playerIndex) => {
                const color = colors[playerIndex];
                player.pieces.forEach((piece, pieceIndex) => {
                    let x, y;

                    if (piece.position === -1) {
                        const homeX = (playerIndex % 2) * 9 * cellSize;
                        const homeY = Math.floor(playerIndex / 2) * 9 * cellSize;
                        const row = Math.floor(pieceIndex / 2);
                        const col = pieceIndex % 2;
                        x = homeX + (col + 1) * 1.5 * cellSize;
                        y = homeY + (row + 1) * 1.5 * cellSize;
                    } else {
                        x = 7.5 * cellSize;
                        y = 7.5 * cellSize;
                    }

                    ludoCtx.beginPath();
                    ludoCtx.arc(x, y, cellSize * 0.3, 0, 2 * Math.PI);
                    ludoCtx.fillStyle = color;
                    ludoCtx.fill();
                    ludoCtx.strokeStyle = "#000";
                    ludoCtx.lineWidth = 2;
                    ludoCtx.stroke();
                });
            });
        }

        function updateLudoGameInterface() {
            if (!currentLudoGame) return;

            const statusEl = document.getElementById("ludo-status");
            const turnEl = document.getElementById("ludo-turn-indicator");
            const rollButton = document.getElementById("roll-dice");

            statusEl.textContent = `Status: ${currentLudoGame.status}`;

            if (currentLudoGame.status === "playing") {
                const currentPlayer = currentLudoGame.players[currentLudoGame.currentPlayerIndex];
                turnEl.textContent = `${currentPlayer.name}'s turn`;
                rollButton.disabled = !currentPlayer.name === 'king' || currentLudoGame.diceRolled;
            } else {
                turnEl.textContent = "Waiting for players...";
                rollButton.disabled = true;
            }
        }

        function rollDice() {
            const diceResult = Math.floor(Math.random() * 6) + 1;
            currentLudoGame.lastDiceRoll = diceResult;
            currentLudoGame.diceRolled = true;
            document.getElementById("dice-result").textContent = diceResult;
            updateLudoGameInterface();
        }

        function leaveLudoGame() {
            currentLudoGame = null;
            document.getElementById("ludo-game").classList.add("hidden");
            document.getElementById("other-games").classList.remove("hidden");
        }

        // Tic Tac Toe
        function startTicTacToe() {
            document.getElementById("other-games").innerHTML = `
                <div class="max-w-2xl mx-auto p-6">
                    <h2 class="text-3xl font-bold mb-6 text-center text-blue-600">‚≠ï Tic Tac Toe</h2>

                    <div class="game-container p-6 rounded-lg shadow-lg mb-6">
                        <div id="tic-tac-toe-board" class="grid grid-cols-3 gap-3 w-80 h-80 mx-auto mb-6">
                            ${Array.from({ length: 9 }, (_, i) => `
                                <div class="bg-gradient-to-br from-blue-50 to-blue-100 border-2 border-blue-300 flex items-center justify-center text-5xl font-bold cursor-pointer hover:from-blue-100 hover:to-blue-200 transition-all duration-200 rounded-lg shadow-md hover:shadow-lg transform hover:scale-105"
                                     onclick="makeTicTacToeMove(${i})"></div>
                            `).join("")}
                        </div>

                        <div class="text-center">
                            <div class="bg-blue-50 p-4 rounded-lg mb-4">
                                <p id="tic-tac-toe-status" class="text-xl font-semibold text-blue-800">Player X's turn</p>
                            </div>
                            <button onclick="resetTicTacToe()" class="bg-gradient-to-r from-blue-600 to-blue-700 text-white px-6 py-3 rounded-lg hover:from-blue-700 hover:to-blue-800 transition-all duration-200 font-semibold shadow-lg hover:shadow-xl transform hover:scale-105">üîÑ Reset Game</button>
                        </div>
                    </div>
                </div>
            `;

            window.ticTacToeBoard = Array(9).fill("");
            window.ticTacToeCurrentPlayer = "X";
        }

        function makeTicTacToeMove(index) {
            if (window.ticTacToeBoard[index] === "" && !checkTicTacToeWinner()) {
                window.ticTacToeBoard[index] = window.ticTacToeCurrentPlayer;
                document.querySelectorAll("#tic-tac-toe-board div")[index].textContent = window.ticTacToeCurrentPlayer;

                const winner = checkTicTacToeWinner();
                if (winner) {
                    document.getElementById("tic-tac-toe-status").textContent = `Player ${winner} wins!`;
                } else if (window.ticTacToeBoard.every((cell) => cell !== "")) {
                    document.getElementById("tic-tac-toe-status").textContent = "It's a draw!";
                } else {
                    window.ticTacToeCurrentPlayer = window.ticTacToeCurrentPlayer === "X" ? "O" : "X";
                    document.getElementById("tic-tac-toe-status").textContent = `Player ${window.ticTacToeCurrentPlayer}'s turn`;
                }
            }
        }

        function checkTicTacToeWinner() {
            const winPatterns = [
                [0, 1, 2], [3, 4, 5], [6, 7, 8],
                [0, 3, 6], [1, 4, 7], [2, 5, 8],
                [0, 4, 8], [2, 4, 6]
            ];

            for (const pattern of winPatterns) {
                const [a, b, c] = pattern;
                if (window.ticTacToeBoard[a] && 
                    window.ticTacToeBoard[a] === window.ticTacToeBoard[b] && 
                    window.ticTacToeBoard[a] === window.ticTacToeBoard[c]) {
                    return window.ticTacToeBoard[a];
                }
            }
            return null;
        }

        function resetTicTacToe() {
            startTicTacToe();
        }

        // Snake Game
        function startSnake() {
            document.getElementById("other-games").innerHTML = `
                <div class="max-w-2xl mx-auto p-6">
                    <h2 class="text-3xl font-bold mb-6 text-center text-green-600">üêç Snake Game</h2>

                    <div class="game-container p-6 rounded-lg shadow-lg">
                        <div class="text-center mb-4">
                            <div class="bg-green-50 p-4 rounded-lg mb-4">
                                <p id="snake-score" class="text-2xl font-bold text-green-800">Score: 0</p>
                            </div>
                        </div>

                        <canvas id="snake-canvas" width="400" height="400" class="border-4 border-green-500 rounded-lg mx-auto block mb-6 shadow-lg bg-black"></canvas>

                        <div class="text-center">
                            <button onclick="startSnakeGame()" class="bg-gradient-to-r from-green-600 to-green-700 text-white px-6 py-3 rounded-lg hover:from-green-700 hover:to-green-800 transition-all duration-200 font-semibold shadow-lg hover:shadow-xl transform hover:scale-105">üéÆ Start Game</button>
                        </div>
                    </div>
                </div>
            `;
        }

        function startSnakeGame() {
            const canvas = document.getElementById("snake-canvas");
            const ctx = canvas.getContext("2d");
            const gridSize = 20;
            const tileCount = canvas.width / gridSize;

            let snake = [{ x: 10, y: 10 }];
            let food = { x: 15, y: 15 };
            let dx = 0, dy = 0, score = 0;

            function drawGame() {
                clearCanvas();
                moveSnake();
                drawSnake();
                drawFood();
                checkCollision();
                updateScore();
            }

            function clearCanvas() {
                ctx.fillStyle = "black";
                ctx.fillRect(0, 0, canvas.width, canvas.height);
            }

            function moveSnake() {
                const head = { x: snake[0].x + dx, y: snake[0].y + dy };
                snake.unshift(head);

                if (head.x === food.x && head.y === food.y) {
                    score += 10;
                    generateFood();
                } else {
                    snake.pop();
                }
            }

            function drawSnake() {
                ctx.fillStyle = "green";
                snake.forEach((segment) => {
                    ctx.fillRect(segment.x * gridSize, segment.y * gridSize, gridSize - 2, gridSize - 2);
                });
            }

            function drawFood() {
                ctx.fillStyle = "red";
                ctx.fillRect(food.x * gridSize, food.y * gridSize, gridSize - 2, gridSize - 2);
            }

            function generateFood() {
                food = {
                    x: Math.floor(Math.random() * tileCount),
                    y: Math.floor(Math.random() * tileCount),
                };
            }

            function checkCollision() {
                const head = snake[0];
                if (head.x < 0 || head.x >= tileCount || head.y < 0 || head.y >= tileCount) {
                    resetGame();
                }
                for (let i = 1; i < snake.length; i++) {
                    if (head.x === snake[i].x && head.y === snake[i].y) {
                        resetGame();
                    }
                }
            }

            function updateScore() {
                document.getElementById("snake-score").textContent = `Score: ${score}`;
            }

            function resetGame() {
                snake = [{ x: 10, y: 10 }];
                dx = 0; dy = 0; score = 0;
                generateFood();
            }

            document.addEventListener("keydown", (e) => {
                const LEFT_KEY = 37, RIGHT_KEY = 39, UP_KEY = 38, DOWN_KEY = 40;
                const keyPressed = e.keyCode;
                const goingUp = dy === -1, goingDown = dy === 1, goingRight = dx === 1, goingLeft = dx === -1;

                if (keyPressed === LEFT_KEY && !goingRight) { dx = -1; dy = 0; }
                if (keyPressed === UP_KEY && !goingDown) { dx = 0; dy = -1; }
                if (keyPressed === RIGHT_KEY && !goingLeft) { dx = 1; dy = 0; }
                if (keyPressed === DOWN_KEY && !goingUp) { dx = 0; dy = 1; }
            });

            setInterval(drawGame, 100);
        }

        // Space Invaders
        function startSpaceInvaders() {
            document.getElementById("other-games").innerHTML = `
                <div class="max-w-3xl mx-auto p-6">
                    <h2 class="text-3xl font-bold mb-6 text-center text-pink-600">üëæ Space Defense</h2>

                    <div class="game-container p-6 rounded-lg shadow-lg">
                        <div class="text-center mb-4">
                            <div class="bg-pink-50 p-4 rounded-lg mb-4">
                                <p id="space-score" class="text-3xl font-bold text-pink-600">Score: 0</p>
                            </div>
                        </div>

                        <canvas id="space-canvas" width="600" height="450" class="border-4 border-pink-500 rounded-lg mx-auto block mb-6 shadow-lg bg-black"></canvas>

                        <div class="text-center">
                            <button onclick="startSpaceGame()" class="bg-gradient-to-r from-pink-600 to-pink-700 text-white px-6 py-3 rounded-lg hover:from-pink-700 hover:to-pink-800 transition-all duration-200 font-semibold shadow-lg hover:shadow-xl transform hover:scale-105">üöÄ Start Game</button>
                        </div>
                    </div>
                </div>
            `;
        }

        function startSpaceGame() {
            const canvas = document.getElementById("space-canvas");
            const ctx = canvas.getContext("2d");

            let player = { x: 275, y: 350, width: 50, height: 30 };
            let bullets = [], enemies = [], score = 0, gameActive = true;

            // Create enemies
            for (let row = 0; row < 5; row++) {
                for (let col = 0; col < 10; col++) {
                    enemies.push({
                        x: col * 45 + 50,
                        y: row * 40 + 50,
                        width: 30,
                        height: 20,
                        alive: true,
                    });
                }
            }

            function gameLoop() {
                if (!gameActive) return;

                ctx.clearRect(0, 0, canvas.width, canvas.height);

                // Update bullets
                bullets = bullets.filter(bullet => {
                    bullet.y -= 5;
                    return bullet.y > 0;
                });

                // Check collisions
                bullets.forEach((bullet, bIndex) => {
                    enemies.forEach((enemy, eIndex) => {
                        if (enemy.alive &&
                            bullet.x < enemy.x + enemy.width &&
                            bullet.x + 3 > enemy.x &&
                            bullet.y < enemy.y + enemy.height &&
                            bullet.y + 10 > enemy.y) {
                            enemy.alive = false;
                            bullets.splice(bIndex, 1);
                            score += 10;
                            document.getElementById("space-score").textContent = `Score: ${score}`;
                        }
                    });
                });

                // Draw player
                ctx.fillStyle = "#00ff00";
                ctx.fillRect(player.x, player.y, player.width, player.height);

                // Draw bullets
                ctx.fillStyle = "#ffff00";
                bullets.forEach(bullet => {
                    ctx.fillRect(bullet.x, bullet.y, 3, 10);
                });

                // Draw enemies
                enemies.forEach(enemy => {
                    if (enemy.alive) {
                        ctx.fillStyle = "#ff0000";
                        ctx.fillRect(enemy.x, enemy.y, enemy.width, enemy.height);
                    }
                });

                requestAnimationFrame(gameLoop);
            }

            document.addEventListener("keydown", (e) => {
                if (!gameActive) return;
                switch (e.key.toLowerCase()) {
                    case "a": if (player.x > 0) player.x -= 10; break;
                    case "d": if (player.x < 550) player.x += 10; break;
                    case " ": 
                        bullets.push({ x: player.x + 23, y: player.y });
                        e.preventDefault();
                        break;
                }
            });

            gameLoop();
        }

        // Memory Game
        function startMemoryGame() {
            document.getElementById("other-games").innerHTML = `
                <div class="max-w-2xl mx-auto p-6">
                    <h2 class="text-xl font-bold mb-4 text-center">üß† Memory Match</h2>
                    <div class="text-center mb-4">
                        <p class="text-lg mb-2">Moves: <span id="memory-moves">0</span> | Matches: <span id="memory-matches">0</span>/8</p>
                        <button onclick="startMemoryRound()" class="bg-cyan-600 text-white px-4 py-2 rounded-lg hover:bg-cyan-700 transition">New Game</button>
                    </div>
                    <div id="memory-board" class="grid grid-cols-4 gap-2 w-80 h-80 mx-auto"></div>
                </div>
            `;
            startMemoryRound();
        }

        function startMemoryRound() {
            const symbols = ["üéØ", "üèÜ", "‚≠ê", "üé™", "üé®", "üé≠", "üöÄ", "üåü", "üéØ", "üèÜ", "‚≠ê", "üé™", "üé®", "üé≠", "üöÄ", "üåü"];
            let flippedCards = [], matches = 0, moves = 0;
            const board = document.getElementById("memory-board");
            board.innerHTML = "";

            // Shuffle
            for (let i = symbols.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [symbols[i], symbols[j]] = [symbols[j], symbols[i]];
            }

            symbols.forEach((symbol, index) => {
                const card = document.createElement("div");
                card.className = "bg-blue-500 border-2 border-blue-700 rounded-lg flex items-center justify-center text-3xl cursor-pointer hover:bg-blue-400 transition";
                card.style.height = "80px";
                card.dataset.symbol = symbol;
                card.textContent = "?";

                card.onclick = () => {
                    if (flippedCards.length >= 2 || card.classList.contains("flipped")) return;

                    card.textContent = card.dataset.symbol;
                    card.classList.add("flipped", "bg-green-400");
                    flippedCards.push(card);

                    if (flippedCards.length === 2) {
                        moves++;
                        document.getElementById("memory-moves").textContent = moves;

                        setTimeout(() => {
                            if (flippedCards[0].dataset.symbol === flippedCards[1].dataset.symbol) {
                                flippedCards.forEach((c) => {
                                    c.classList.add("bg-green-600");
                                    c.onclick = null;
                                });
                                matches++;
                                document.getElementById("memory-matches").textContent = matches;
                                if (matches === 8) {
                                    setTimeout(() => alert(`Congratulations! You won in ${moves} moves!`), 100);
                                }
                            } else {
                                flippedCards.forEach((c) => {
                                    c.textContent = "?";
                                    c.classList.remove("flipped", "bg-green-400");
                                });
                            }
                            flippedCards = [];
                        }, 1000);
                    }
                };
                board.appendChild(card);
            });

            document.getElementById("memory-moves").textContent = "0";
            document.getElementById("memory-matches").textContent = "0";
        }

        // UNO Game
        function startUNO() {
            document.getElementById("other-games").innerHTML = `
                <div class="max-w-4xl mx-auto p-6">
                    <h2 class="text-3xl font-bold mb-6 text-center bg-gradient-to-r from-red-600 to-blue-600 bg-clip-text text-transparent">üÉè UNO Game</h2>

                    <div class="game-container p-6 rounded-lg shadow-lg">
                        <div class="uno-game-container">
                            <div class="text-center mb-4">
                                <div class="bg-gradient-to-r from-red-50 to-blue-50 p-4 rounded-lg mb-4">
                                    <p id="uno-status" class="text-xl font-semibold text-gray-800">Your turn!</p>
                                </div>
                            </div>

                            <div class="grid grid-cols-1 lg:grid-cols-3 gap-6 mb-6">
                                <div class="bg-gray-100 p-4 rounded-lg">
                                    <h3 class="text-lg font-bold mb-2 text-center">ü§ñ Computer</h3>
                                    <div id="computer-hand" class="flex justify-center flex-wrap gap-1"></div>
                                    <p class="text-center mt-2 text-sm text-gray-600">Cards: <span id="computer-card-count">7</span></p>
                                </div>

                                <div class="text-center">
                                    <h3 class="text-lg font-bold mb-2">Draw & Discard</h3>
                                    <div class="flex justify-center items-center gap-4">
                                        <div class="uno-card back-card cursor-pointer hover:scale-105 transition-transform" onclick="drawCard()">
                                            <div class="card-content">üÉè</div>
                                        </div>
                                        <div id="discard-pile" class="uno-card" style="background: linear-gradient(45deg, #ff0000, #0000ff);">
                                            <div class="card-content">Start</div>
                                        </div>
                                    </div>
                                    <button onclick="resetUNO()" class="bg-gray-600 text-white px-4 py-2 rounded-lg hover:bg-gray-700 transition mt-4">üîÑ Reset</button>
                                </div>

                                <div class="bg-gray-100 p-4 rounded-lg">
                                    <h3 class="text-lg font-bold mb-2 text-center">Choose Color</h3>
                                    <div id="color-selector" class="grid grid-cols-2 gap-2" style="display: none;">
                                        <button onclick="chooseWildColor('red')" class="bg-red-500 text-white p-3 rounded-lg hover:bg-red-600 transition">Red</button>
                                        <button onclick="chooseWildColor('blue')" class="bg-blue-500 text-white p-3 rounded-lg hover:bg-blue-600 transition">Blue</button>
                                        <button onclick="chooseWildColor('green')" class="bg-green-500 text-white p-3 rounded-lg hover:bg-green-600 transition">Green</button>
                                        <button onclick="chooseWildColor('yellow')" class="bg-yellow-500 text-black p-3 rounded-lg hover:bg-yellow-600 transition">Yellow</button>
                                    </div>
                                </div>
                            </div>

                            <div class="bg-gradient-to-r from-red-100 to-blue-100 p-4 rounded-lg">
                                <h3 class="text-lg font-bold mb-2 text-center">üë§ Your Hand</h3>
                                <div id="player-hand" class="flex justify-center flex-wrap gap-2"></div>
                                <p class="text-center mt-2 text-sm text-gray-600">Cards: <span id="player-card-count">7</span></p>
                            </div>
                        </div>
                    </div>
                </div>
            `;

            window.unoGame = new UNOGame();
            window.unoGame.startGame();
        }

        class UNOGame {
            constructor() {
                this.colors = ['red', 'blue', 'green', 'yellow'];
                this.deck = [];
                this.playerHand = [];
                this.computerHand = [];
                this.discardPile = [];
                this.currentColor = '';
                this.playerTurn = true;
            }

            createDeck() {
                this.deck = [];
                this.colors.forEach(color => {
                    for (let i = 0; i <= 9; i++) {
                        this.deck.push({ color, value: i.toString(), type: 'number' });
                        if (i > 0) this.deck.push({ color, value: i.toString(), type: 'number' });
                    }
                });
                this.shuffleDeck();
            }

            shuffleDeck() {
                for (let i = this.deck.length - 1; i > 0; i--) {
                    const j = Math.floor(Math.random() * (i + 1));
                    [this.deck[i], this.deck[j]] = [this.deck[j], this.deck[i]];
                }
            }

            startGame() {
                this.createDeck();
                for (let i = 0; i < 7; i++) {
                    this.playerHand.push(this.deck.pop());
                    this.computerHand.push(this.deck.pop());
                }
                
                let firstCard = this.deck.pop();
                this.discardPile.push(firstCard);
                this.currentColor = firstCard.color;
                this.updateDisplay();
            }

            updateDisplay() {
                this.updatePlayerHand();
                this.updateComputerHand();
                this.updateDiscardPile();
                document.getElementById('player-card-count').textContent = this.playerHand.length;
                document.getElementById('computer-card-count').textContent = this.computerHand.length;
            }

            updatePlayerHand() {
                const handElement = document.getElementById('player-hand');
                handElement.innerHTML = '';
                
                this.playerHand.forEach((card, index) => {
                    const cardElement = document.createElement('div');
                    cardElement.className = `uno-card ${card.color}-card`;
                    cardElement.innerHTML = `<div class="card-content">${card.value}</div>`;
                    cardElement.onclick = () => this.playCard(index);
                    
                    if (!this.canPlayCard(card)) {
                        cardElement.style.opacity = '0.5';
                    }
                    
                    handElement.appendChild(cardElement);
                });
            }

            updateComputerHand() {
                const handElement = document.getElementById('computer-hand');
                handElement.innerHTML = '';
                
                this.computerHand.forEach(() => {
                    const cardElement = document.createElement('div');
                    cardElement.className = 'uno-card back-card';
                    cardElement.innerHTML = '<div class="card-content">üÉè</div>';
                    handElement.appendChild(cardElement);
                });
            }

            updateDiscardPile() {
                const topCard = this.discardPile[this.discardPile.length - 1];
                const discardElement = document.getElementById('discard-pile');
                discardElement.className = `uno-card ${topCard.color}-card`;
                discardElement.innerHTML = `<div class="card-content">${topCard.value}</div>`;
            }

            canPlayCard(card) {
                return card.color === this.currentColor || card.value === this.discardPile[this.discardPile.length - 1].value;
            }

            playCard(cardIndex) {
                if (!this.playerTurn) return;
                
                const card = this.playerHand[cardIndex];
                if (!this.canPlayCard(card)) return;
                
                this.playerHand.splice(cardIndex, 1);
                this.discardPile.push(card);
                this.currentColor = card.color;
                
                if (this.playerHand.length === 0) {
                    alert('You win!');
                    return;
                }
                
                this.playerTurn = false;
                this.updateDisplay();
                setTimeout(() => this.computerPlay(), 1000);
            }

            computerPlay() {
                const playableCards = this.computerHand.filter(card => this.canPlayCard(card));
                
                if (playableCards.length === 0) {
                    if (this.deck.length > 0) {
                        this.computerHand.push(this.deck.pop());
                    }
                } else {
                    const cardToPlay = playableCards[Math.floor(Math.random() * playableCards.length)];
                    const cardIndex = this.computerHand.indexOf(cardToPlay);
                    this.computerHand.splice(cardIndex, 1);
                    this.discardPile.push(cardToPlay);
                    this.currentColor = cardToPlay.color;
                    
                    if (this.computerHand.length === 0) {
                        alert('Computer wins!');
                        return;
                    }
                }
                
                this.playerTurn = true;
                this.updateDisplay();
            }
        }

        window.drawCard = function() {
            if (window.unoGame && window.unoGame.playerTurn && window.unoGame.deck.length > 0) {
                window.unoGame.playerHand.push(window.unoGame.deck.pop());
                window.unoGame.playerTurn = false;
                window.unoGame.updateDisplay();
                setTimeout(() => window.unoGame.computerPlay(), 1000);
            }
        };

        window.chooseWildColor = function(color) {
            if (window.unoGame) {
                window.unoGame.currentColor = color;
                document.getElementById('color-selector').style.display = 'none';
                window.unoGame.playerTurn = false;
                window.unoGame.updateDisplay();
                setTimeout(() => window.unoGame.computerPlay(), 1000);
            }
        };

        window.resetUNO = function() {
            startUNO();
        };

        // Hangman Game
        function startHangman() {
            const words = ['JAVASCRIPT', 'COMPUTER', 'PROGRAMMING', 'HANGMAN', 'CHALLENGE'];
            
            document.getElementById("other-games").innerHTML = `
                <div class="max-w-4xl mx-auto p-6">
                    <h2 class="text-3xl font-bold mb-6 text-center text-red-600">üéØ Hangman Game</h2>

                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                        <div class="game-container p-6 rounded-lg shadow-lg">
                            <div id="hangman-drawing" class="text-6xl mb-4 font-mono bg-gray-100 p-4 rounded-lg min-h-32 flex items-center justify-center">
                                <div id="gallows">
                                    <div class="text-4xl">‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê</div>
                                    <div class="text-4xl">‚îÇ     ‚îÇ</div>
                                    <div class="text-4xl">‚îÇ      </div>
                                    <div class="text-4xl">‚îÇ      </div>
                                    <div class="text-4xl">‚îÇ      </div>
                                    <div class="text-4xl">‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ</div>
                                </div>
                            </div>

                            <div class="mb-4">
                                <div id="word-display" class="text-3xl font-bold tracking-widest text-gray-800 mb-4 font-mono">_ _ _ _ _ _ _ _ _</div>
                            </div>

                            <div class="grid grid-cols-2 gap-4 text-sm">
                                <div class="bg-green-50 p-3 rounded-lg">
                                    <p class="text-green-800">Correct: <span id="correct-letters">None</span></p>
                                </div>
                                <div class="bg-red-50 p-3 rounded-lg">
                                    <p class="text-red-800">Wrong: <span id="wrong-letters">None</span> (<span id="wrong-count">0</span>/6)</p>
                                </div>
                            </div>
                        </div>

                        <div class="game-container p-6 rounded-lg shadow-lg">
                            <div class="mb-6">
                                <div class="flex gap-2">
                                    <input type="text" id="letter-input" maxlength="1" class="flex-1 p-3 border-2 border-gray-300 rounded-lg text-center text-xl font-bold uppercase" placeholder="A-Z">
                                    <button onclick="guessLetter()" class="bg-red-600 text-white px-6 py-3 rounded-lg hover:bg-red-700 transition font-semibold">Guess</button>
                                </div>
                            </div>

                            <div class="mb-6">
                                <h3 class="text-lg font-semibold mb-3">Alphabet</h3>
                                <div id="alphabet" class="grid grid-cols-6 gap-2">
                                    ${Array.from('ABCDEFGHIJKLMNOPQRSTUVWXYZ').map(letter => `
                                        <button onclick="selectLetter('${letter}')" class="letter-btn bg-blue-100 hover:bg-blue-200 border border-blue-300 p-2 rounded font-semibold text-blue-800 transition" data-letter="${letter}">${letter}</button>
                                    `).join('')}
                                </div>
                            </div>

                            <div class="text-center">
                                <button onclick="startNewHangmanGame()" class="w-full bg-green-600 text-white px-6 py-3 rounded-lg hover:bg-green-700 transition font-semibold">üéÆ New Game</button>
                            </div>
                        </div>
                    </div>

                    <div id="game-result" class="hidden mt-6 p-4 rounded-lg text-center">
                        <h3 id="result-title" class="text-2xl font-bold mb-2"></h3>
                        <p id="result-message" class="text-lg mb-4"></p>
                        <button onclick="startNewHangmanGame()" class="bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 transition font-semibold">Play Again</button>
                    </div>
                </div>
            `;

            window.hangmanGame = {
                words: words,
                currentWord: '',
                guessedLetters: [],
                wrongGuesses: 0,
                maxWrongGuesses: 6,
                gameOver: false
            };

            startNewHangmanGame();
        }

        function startNewHangmanGame() {
            const game = window.hangmanGame;
            game.currentWord = game.words[Math.floor(Math.random() * game.words.length)];
            game.guessedLetters = [];
            game.wrongGuesses = 0;
            game.gameOver = false;

            updateHangmanDisplay();
            updateHangmanDrawing();
            resetAlphabet();
            document.getElementById('letter-input').value = '';
            document.getElementById('game-result').classList.add('hidden');
        }

        function selectLetter(letter) {
            document.getElementById('letter-input').value = letter;
            guessLetter();
        }

        function guessLetter() {
            const game = window.hangmanGame;
            const letter = document.getElementById('letter-input').value.toUpperCase().trim();

            if (!letter || game.guessedLetters.includes(letter) || game.gameOver) return;

            game.guessedLetters.push(letter);
            const letterBtn = document.querySelector(`[data-letter="${letter}"]`);
            letterBtn.disabled = true;

            if (game.currentWord.includes(letter)) {
                letterBtn.classList.add('bg-green-100', 'border-green-300', 'text-green-800');
                updateHangmanDisplay();
                if (game.currentWord.split('').every(l => game.guessedLetters.includes(l))) {
                    game.gameOver = true;
                    showGameResult(true);
                }
            } else {
                letterBtn.classList.add('bg-red-100', 'border-red-300', 'text-red-800');
                game.wrongGuesses++;
                updateHangmanDrawing();
                if (game.wrongGuesses >= game.maxWrongGuesses) {
                    game.gameOver = true;
                    showGameResult(false);
                }
            }

            updateGuessDisplay();
            document.getElementById('letter-input').value = '';
        }

        function updateHangmanDisplay() {
            const game = window.hangmanGame;
            const display = game.currentWord.split('').map(letter => 
                game.guessedLetters.includes(letter) ? letter : '_'
            ).join(' ');
            document.getElementById('word-display').textContent = display;
        }

        function updateHangmanDrawing() {
            const drawings = [
                "‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê\n‚îÇ     ‚îÇ\n‚îÇ      \n‚îÇ      \n‚îÇ      \n‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ",
                "‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê\n‚îÇ     ‚îÇ\n‚îÇ     üòµ\n‚îÇ      \n‚îÇ      \n‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ",
                "‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê\n‚îÇ     ‚îÇ\n‚îÇ     üòµ\n‚îÇ     ‚îÇ\n‚îÇ      \n‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ",
                "‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê\n‚îÇ     ‚îÇ\n‚îÇ     üòµ\n‚îÇ    /‚îÇ\n‚îÇ      \n‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ",
                "‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê\n‚îÇ     ‚îÇ\n‚îÇ     üòµ\n‚îÇ    /‚îÇ\\\n‚îÇ      \n‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ",
                "‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê\n‚îÇ     ‚îÇ\n‚îÇ     üòµ\n‚îÇ    /‚îÇ\\\n‚îÇ    / \n‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ",
                "‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê\n‚îÇ     ‚îÇ\n‚îÇ     üòµ\n‚îÇ    /‚îÇ\\\n‚îÇ    / \\\n‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ"
            ];

            const drawing = drawings[window.hangmanGame.wrongGuesses] || drawings[0];
            document.getElementById('gallows').innerHTML = drawing.split('\n').map(line => 
                `<div class="text-4xl">${line}</div>`
            ).join('');
        }

        function updateGuessDisplay() {
            const game = window.hangmanGame;
            const correctLetters = game.guessedLetters.filter(letter => game.currentWord.includes(letter));
            const wrongLetters = game.guessedLetters.filter(letter => !game.currentWord.includes(letter));

            document.getElementById('correct-letters').textContent = correctLetters.length ? correctLetters.join(', ') : 'None';
            document.getElementById('wrong-letters').textContent = wrongLetters.length ? wrongLetters.join(', ') : 'None';
            document.getElementById('wrong-count').textContent = game.wrongGuesses;
        }

        function resetAlphabet() {
            document.querySelectorAll('.letter-btn').forEach(btn => {
                btn.disabled = false;
                btn.className = 'letter-btn bg-blue-100 hover:bg-blue-200 border border-blue-300 p-2 rounded font-semibold text-blue-800 transition';
            });
        }

        function showGameResult(won) {
            const resultDiv = document.getElementById('game-result');
            const titleEl = document.getElementById('result-title');
            const messageEl = document.getElementById('result-message');

            if (won) {
                resultDiv.className = 'mt-6 p-4 rounded-lg text-center bg-green-100 border border-green-300';
                titleEl.textContent = 'üéâ Congratulations!';
                titleEl.className = 'text-2xl font-bold mb-2 text-green-800';
                messageEl.textContent = `You guessed "${window.hangmanGame.currentWord}" correctly!`;
                messageEl.className = 'text-lg mb-4 text-green-700';
            } else {
                resultDiv.className = 'mt-6 p-4 rounded-lg text-center bg-red-100 border border-red-300';
                titleEl.textContent = 'üíÄ Game Over!';
                titleEl.className = 'text-2xl font-bold mb-2 text-red-800';
                messageEl.textContent = `The word was "${window.hangmanGame.currentWord}". Better luck next time!`;
                messageEl.className = 'text-lg mb-4 text-red-700';
            }

            resultDiv.classList.remove('hidden');
        }

        // Typing Master
        function startTypingMaster() {
            const typingLessons = [
                { title: "Basic Home Row Keys", text: "asdf jkl; asdf jkl; fff jjj ddd kkk sss lll aaa ;;;" },
                { title: "Common Words", text: "the quick brown fox jumps over the lazy dog" },
                { title: "Numbers", text: "1234567890 1234567890 111 222 333 444 555 666 777 888 999 000" }
            ];

            document.getElementById("other-games").innerHTML = `
                <h2 class="text-xl font-bold mb-4 text-center">‚å®Ô∏è Typing Master</h2>
                <div class="max-w-4xl mx-auto">
                    <div class="grid grid-cols-1 lg:grid-cols-3 gap-4 mb-6">
                        <div class="bg-blue-100 p-4 rounded-lg text-center">
                            <h3 class="font-semibold text-blue-800">WPM</h3>
                            <p id="typing-wpm" class="text-2xl font-bold text-blue-600">0</p>
                        </div>
                        <div class="bg-green-100 p-4 rounded-lg text-center">
                            <h3 class="font-semibold text-green-800">Accuracy</h3>
                            <p id="typing-accuracy" class="text-2xl font-bold text-green-600">100%</p>
                        </div>
                        <div class="bg-purple-100 p-4 rounded-lg text-center">
                            <h3 class="font-semibold text-purple-800">Time</h3>
                            <p id="typing-time" class="text-2xl font-bold text-purple-600">0s</p>
                        </div>
                    </div>

                    <div class="mb-4">
                        <select id="lesson-select" class="w-full p-2 border rounded-lg">
                            ${typingLessons.map((lesson, index) => 
                                `<option value="${index}">${index + 1}. ${lesson.title}</option>`
                            ).join("")}
                        </select>
                    </div>

                    <div id="text-to-type" class="bg-white p-4 rounded-lg border text-lg font-mono mb-4">${typingLessons[0].text}</div>

                    <div class="mb-4">
                        <textarea id="typing-input" placeholder="Start typing here..." class="w-full p-4 border rounded-lg" rows="6" disabled></textarea>
                    </div>

                    <div class="text-center">
                        <button onclick="startTypingTest()" class="bg-green-600 text-white px-6 py-3 rounded-lg hover:bg-green-700 transition mr-2">Start Test</button>
                        <button onclick="resetTypingTest()" class="bg-gray-600 text-white px-6 py-3 rounded-lg hover:bg-gray-700 transition">Reset</button>
                    </div>
                </div>
            `;

            window.typingLessons = typingLessons;
            window.currentLesson = 0;
            window.typingStartTime = null;
            window.typingTestActive = false;
        }

        window.startTypingTest = function() {
            const input = document.getElementById("typing-input");
            input.disabled = false;
            input.focus();
            window.typingStartTime = Date.now();
            window.typingTestActive = true;
            window.typingInterval = setInterval(updateTypingStats, 100);
        };

        function updateTypingStats() {
            if (!window.typingTestActive || !window.typingStartTime) return;

            const input = document.getElementById("typing-input");
            const timeElapsed = (Date.now() - window.typingStartTime) / 1000;
            const wordsTyped = input.value.trim().split(/\s+/).length;
            const wpm = Math.round((wordsTyped / timeElapsed) * 60) || 0;

            document.getElementById("typing-wpm").textContent = wpm;
            document.getElementById("typing-time").textContent = Math.round(timeElapsed) + "s";
        }

        window.resetTypingTest = function() {
            window.typingTestActive = false;
            clearInterval(window.typingInterval);
            document.getElementById("typing-input").value = "";
            document.getElementById("typing-input").disabled = true;
            document.getElementById("typing-wpm").textContent = "0";
            document.getElementById("typing-accuracy").textContent = "100%";
            document.getElementById("typing-time").textContent = "0s";
        };

        // Rock Paper Scissors
        function startRockPaperScissors() {
            document.getElementById("other-games").innerHTML = `
                <div class="max-w-2xl mx-auto p-6">
                    <h2 class="text-3xl font-bold mb-6 text-center text-orange-600">‚úÇÔ∏è Rock Paper Scissors</h2>

                    <div class="game-container p-6 rounded-lg shadow-lg">
                        <div class="text-center mb-6">
                            <div class="bg-orange-50 p-4 rounded-lg mb-4">
                                <p class="text-lg">Score - You: <span id="player-score">0</span> | Computer: <span id="computer-score">0</span></p>
                            </div>
                        </div>

                        <div class="grid grid-cols-2 gap-8 mb-6">
                            <div class="text-center">
                                <h3 class="text-xl font-bold mb-4">Your Choice</h3>
                                <div id="player-choice" class="text-6xl mb-4">‚ùì</div>
                            </div>
                            <div class="text-center">
                                <h3 class="text-xl font-bold mb-4">Computer Choice</h3>
                                <div id="computer-choice" class="text-6xl mb-4">‚ùì</div>
                            </div>
                        </div>

                        <div class="text-center mb-6">
                            <p id="game-message" class="text-xl font-semibold text-gray-800">Make your choice!</p>
                        </div>

                        <div class="grid grid-cols-3 gap-4 mb-6">
                            <button onclick="playRPS('rock')" class="bg-gray-600 text-white text-4xl p-4 rounded-lg hover:bg-gray-700 transition">ü™®</button>
                            <button onclick="playRPS('paper')" class="bg-white text-4xl p-4 rounded-lg border-2 hover:bg-gray-100 transition">üìÑ</button>
                            <button onclick="playRPS('scissors')" class="bg-orange-600 text-white text-4xl p-4 rounded-lg hover:bg-orange-700 transition">‚úÇÔ∏è</button>
                        </div>

                        <div class="text-center">
                            <button onclick="resetRPS()" class="bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 transition">üîÑ Reset Game</button>
                        </div>
                    </div>
                </div>
            `;

            window.rpsScore = { player: 0, computer: 0 };
        }

        function playRPS(playerChoice) {
            const choices = ['rock', 'paper', 'scissors'];
            const computerChoice = choices[Math.floor(Math.random() * 3)];
            
            const choiceEmojis = { rock: 'ü™®', paper: 'üìÑ', scissors: '‚úÇÔ∏è' };
            
            document.getElementById('player-choice').textContent = choiceEmojis[playerChoice];
            document.getElementById('computer-choice').textContent = choiceEmojis[computerChoice];
            
            let result;
            if (playerChoice === computerChoice) {
                result = "It's a tie!";
            } else if (
                (playerChoice === 'rock' && computerChoice === 'scissors') ||
                (playerChoice === 'paper' && computerChoice === 'rock') ||
                (playerChoice === 'scissors' && computerChoice === 'paper')
            ) {
                result = "You win!";
                window.rpsScore.player++;
            } else {
                result = "Computer wins!";
                window.rpsScore.computer++;
            }
            
            document.getElementById('game-message').textContent = result;
            document.getElementById('player-score').textContent = window.rpsScore.player;
            document.getElementById('computer-score').textContent = window.rpsScore.computer;
        }

        function resetRPS() {
            window.rpsScore = { player: 0, computer: 0 };
            document.getElementById('player-choice').textContent = '‚ùì';
            document.getElementById('computer-choice').textContent = '‚ùì';
            document.getElementById('game-message').textContent = 'Make your choice!';
            document.getElementById('player-score').textContent = '0';
            document.getElementById('computer-score').textContent = '0';
        }

        // Number Guessing Game
        function startNumberGuess() {
            document.getElementById("other-games").innerHTML = `
                <h2 class="text-xl font-bold mb-4 text-center">üî¢ Number Guessing Game</h2>
                <div class="text-center">
                    <p class="text-lg mb-4">I'm thinking of a number between 1 and 100!</p>
                    <div class="mb-4">
                        <input type="number" id="guess-input" class="border-2 border-gray-300 rounded-lg px-4 py-2 mr-2" placeholder="Enter your guess" min="1" max="100">
                        <button onclick="makeGuess()" class="bg-gray-600 text-white px-4 py-2 rounded-lg hover:bg-gray-700 transition">Guess</button>
                    </div>
                    <p id="guess-feedback" class="text-lg font-semibold mb-2"></p>
                    <p id="guess-attempts" class="text-md mb-4">Attempts: 0</p>
                    <button onclick="startNumberGuess()" class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition">New Game</button>
                </div>
            `;

            window.targetNumber = Math.floor(Math.random() * 100) + 1;
            window.attempts = 0;
        }

        function makeGuess() {
            const input = document.getElementById("guess-input");
            const guess = parseInt(input.value);

            if (!guess || guess < 1 || guess > 100) {
                document.getElementById("guess-feedback").textContent = "Please enter a number between 1 and 100!";
                return;
            }

            window.attempts++;
            document.getElementById("guess-attempts").textContent = `Attempts: ${window.attempts}`;

            if (guess === window.targetNumber) {
                document.getElementById("guess-feedback").innerHTML = `üéâ Correct! You guessed it in ${window.attempts} attempts!`;
                input.disabled = true;
            } else if (guess < window.targetNumber) {
                document.getElementById("guess-feedback").textContent = "üìà Too low! Try a higher number.";
            } else {
                document.getElementById("guess-feedback").textContent = "üìâ Too high! Try a lower number.";
            }

            input.value = "";
        }

        // Join by ID functionality
        document.getElementById('join-by-id-btn').addEventListener('click', async () => {
            const gameId = document.getElementById('game-id-input').value.trim();
            if (!gameId) {
                alert('Please enter a Game ID');
                return;
            }

            if (gameId.startsWith('chess_')) {
                await joinGame(gameId);
            } else if (gameId.startsWith('ludo_')) {
                await joinLudoGame(gameId);
            } else {
                alert('Invalid Game ID format');
            }
        });

        async function joinLudoGame(gameId) {
            // Mock join - in real implementation this would connect to server
            alert(`Attempting to join Ludo game: ${gameId}`);
        }

        // Copy game ID function
        function copyGameId(gameId) {
            navigator.clipboard.writeText(gameId).then(() => {
                alert('Game ID copied to clipboard!');
            });
        }

        // Initialize
        initializeWebSocket();
    </script>
</body>
</html>
